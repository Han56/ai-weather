<navigation-bar title="æ™ºèƒ½çœ‹å¤©æ°”" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<scroll-view scroll-y="true" class="container">
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
  <block wx:else>
    <!-- ä¸ŠåŠéƒ¨åˆ†ï¼šå½“å‰å¤©æ°”ä¿¡æ¯ -->
    <view class="weather-container">
      <!-- å¤´éƒ¨æ ‡é¢˜æ  -->
      <view class="header">
        <text class="title">å®æ—¶å¤©æ°”</text>
        <view class="location" bindtap="openCitySelector">
          <text>{{selectedCity}}</text>
          <text class="arrow">â–¼</text>
        </view>
      </view>

      <!-- ä¸»è¦å¤©æ°”ä¿¡æ¯ -->
      <view class="main-weather">
        <view class="temperature-section">
          <text class="temperature">{{currentTemp}}</text>
          <view class="weather-desc">
            <text>{{tempDescription}}</text>
          </view>
        </view>
        
        <!-- é¢„è­¦å’Œä½“æ„Ÿæ¸©åº¦ - ä¿æŒä¸€è¡Œ -->
        <view class="alert-section">
          <view class="alert-item">
            <text class="alert-label">{{warning}}</text>
          </view>
          <view class="feels-like-item">
            <text class="feels-like-label">ä½“æ„Ÿæ¸©åº¦</text>
            <text class="feels-like-temp">{{feelsLike}}</text>
          </view>
        </view>
      </view>

      <!-- ä¹å®«æ ¼å¤©æ°”è¯¦æƒ… -->
      <view class="weather-grid">
        <view class="grid-item">
          <text class="grid-icon">â˜€ï¸</text>
          <text class="grid-label">å¤©æ°”çŠ¶å†µ</text>
          <view class="grid-tag blue">{{weatherDetails.condition}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸ’§</text>
          <text class="grid-label">æ¹¿åº¦</text>
          <view class="grid-tag blue">{{weatherDetails.humidity}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸ“Š</text>
          <text class="grid-label">æ°”å‹</text>
          <view class="grid-tag purple">{{weatherDetails.pressure}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸŒ</text>
          <text class="grid-label">UVIï¼ˆç´«å¤–çº¿ï¼‰</text>
          <view class="grid-tag yellow">{{weatherDetails.uvi}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸ’¨</text>
          <text class="grid-label">é£é€Ÿ</text>
          <view class="grid-tag green">{{weatherDetails.windSpeed}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸ§­</text>
          <text class="grid-label">é£å‘</text>
          <view class="grid-tag orange">{{weatherDetails.windDirection}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸŒ¿</text>
          <text class="grid-label">ç©ºæ°”è´¨é‡</text>
          <view class="grid-tag green">{{aqi}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸŒ…</text>
          <text class="grid-label">æ—¥å‡º</text>
          <view class="grid-tag orange">{{weatherDetails.sunrise}}</view>
        </view>
        <view class="grid-item">
          <text class="grid-icon">ğŸŒ‡</text>
          <text class="grid-label">æ—¥è½</text>
          <view class="grid-tag purple">{{weatherDetails.sunset}}</view>
        </view>
      </view>
    </view>
    
    <!-- æ–°å¢ï¼šæœªæ¥5å°æ—¶å¤©æ°”æ¨¡å— -->
    <view class="hourly-summary-container">
      <view wx:if="{{hourlySummaryLoading}}" class="hourly-summary-loading">æœªæ¥5å°æ—¶å¤©æ°”åŠ è½½ä¸­...</view>
      <block wx:elif="{{hourlySummary}}">
        <view class="hourly-summary-title">æœªæ¥5å°æ—¶å¤©æ°”æ¦‚å†µ</view>
        <view class="hourly-summary-section">
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">é™æ°´</text>
            <text class="hourly-summary-value">{{hourlySummary.precipitation.summary}}</text>
          </view>
          <view class="hourly-summary-hours">
            <block wx:for="{{hourlySummary.precipitation.hours}}" wx:key="hour">
              <view class="hourly-hour-item">
                <text class="hourly-hour">{{item.hour}}æ—¶</text>
                <text class="hourly-hour-condition">{{item.condition}}</text>
              </view>
            </block>
          </view>
        </view>
        <view class="hourly-summary-section">
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">æ°”æ¸©</text>
            <text class="hourly-summary-value">{{hourlySummary.temperature.summary}}</text>
          </view>
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">åŒºé—´</text>
            <text class="hourly-summary-value">{{hourlySummary.temperature.min}}Â°C ~ {{hourlySummary.temperature.max}}Â°C</text>
          </view>
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">æ¹¿åº¦</text>
            <text class="hourly-summary-value">{{hourlySummary.temperature.humidity_analysis}}</text>
          </view>
        </view>
        <view class="hourly-summary-section">
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">é£é€Ÿ</text>
            <text class="hourly-summary-value">{{hourlySummary.wind.summary}}</text>
          </view>
        </view>
        <view class="hourly-summary-section">
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">ç´«å¤–çº¿</text>
            <text class="hourly-summary-value">{{hourlySummary.uv.summary}}</text>
          </view>
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">èŒƒå›´</text>
            <text class="hourly-summary-value">{{hourlySummary.uv.range.min}} ~ {{hourlySummary.uv.range.max}}</text>
          </view>
          <view class="hourly-summary-row">
            <text class="hourly-summary-label">è¶‹åŠ¿</text>
            <text class="hourly-summary-value">{{hourlySummary.uv.trend}}</text>
          </view>
        </view>
      </block>
      <view wx:else class="hourly-summary-empty">æš‚æ— æœªæ¥5å°æ—¶å¤©æ°”æ•°æ®</view>
    </view>
    <!-- æœªæ¥5å°æ—¶å¤©æ°”æ¨¡å—ç»“æŸ -->

    <!-- ä¸‹åŠéƒ¨åˆ†ï¼š10æ—¥å¤©æ°”é¢„æŠ¥ -->
    <view class="forecast-container">
      <view class="forecast-header">
        <view class="forecast-icon">
          <text class="icon-calendar"></text>
        </view>
        <view class="forecast-title">æœªæ¥10å¤©-å¤©æ°”é¢„æŠ¥</view>
      </view>
      
      <view class="forecast-list">
        <block wx:for="{{forecast}}" wx:key="date">
          <view class="forecast-item">
            <view class="day">{{item.day}}</view>
            <view class="date">{{item.date}}</view>
            <view class="weather-condition">{{item.condition}}</view>
            <view class="weather-icon icon-{{item.icon}}">
            </view>
            <view class="temp-container">
              <view class="low-temp">{{item.lowTemp}}</view>
              <view class="temp-separator">~</view>
              <view class="high-temp">{{item.highTemp}}</view>
            </view>
            <view class="wind-info">
              <text class="wind-dir">{{item.windDir}}</text>
              <text class="wind-level">{{item.windLevel}}çº§</text>
            </view>
          </view>
        </block>
        <view style="height: 90px;"></view>
      </view>
    </view>
  </block>
</scroll-view>
